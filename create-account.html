<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open Bank Account</title>
<style>
body { font-family: Arial; background:#f2f2f2; display:flex; justify-content:center; align-items:flex-start; padding-top:30px; margin:0; }
.form-box { background:white; padding:35px 30px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.2); width:450px; max-width:95%; }
h2 { text-align:center; margin-bottom:10px; font-size:24px; }
p.description { text-align:center; color:#555; margin-bottom:25px; font-size:15px; }
input, select { padding:14px; width:100%; margin:12px 0; border-radius:8px; border:1px solid #ccc; font-size:16px; }
button { padding:14px; width:100%; background:#002868; color:white; border:none; border-radius:8px; cursor:pointer; font-size:17px; margin-top:10px; }
button:hover { background:#001f5a; }
</style>
</head>
<body>

<div class="form-box">
  <h2>Open Your Bank Account</h2>
  <p class="description">Fill in all the details below to create a new bank account. All information is required for verification.</p>
  <form id="registerForm">
    <input type="text" id="firstName" placeholder="First Name" required>
    <input type="text" id="lastName" placeholder="Last Name" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="text" id="phone" placeholder="Phone Number" required>
    <input type="text" id="username" placeholder="Choose Username" required>
    <input type="password" id="password" placeholder="Choose Password" required>
    <input type="number" id="pin" placeholder="4-Digit PIN" required min="1000" max="9999">
    <select id="gender" required>
      <option value="">-- Select Gender --</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
      <option value="Other">Other</option>
    </select>
    <input type="date" id="dob" placeholder="Date of Birth" required>
    <input type="text" id="ssn" placeholder="Social Security Number (SSN)" required>
    <input type="text" id="address" placeholder="Full Address" required>
    <input type="text" id="nationality" placeholder="Nationality" required>
    <select id="accountType" required>
      <option value="">-- Select Account Type --</option>
      <option value="Savings">Savings Account</option>
      <option value="Checking">Checking Account</option>
    </select>
    <input type="file" id="photo" accept="image/*" required>
    <button type="submit">Register</button>
  </form>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCzqzO69UPV23oBHU3JAcvZjwEcsv3TtJY",
  authDomain: "bank-of-america-92490.firebaseapp.com",
  projectId: "bank-of-america-92490",
  storageBucket: "bank-of-america-92490.firebasestorage.app",
  messagingSenderId: "926628493178",
  appId: "1:926628493178:web:775a66629b654d80f348c3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

document.getElementById("registerForm").addEventListener("submit", async function(e){
  e.preventDefault();

  const firstName = document.getElementById("firstName").value;
  const lastName = document.getElementById("lastName").value;
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const username = document.getElementById("username").value;
  const pin = document.getElementById("pin").value;
  const accountType = document.getElementById("accountType").value;
  const gender = document.getElementById("gender").value;
  const dob = document.getElementById("dob").value;
  const ssn = document.getElementById("ssn").value;
  const address = document.getElementById("address").value;
  const nationality = document.getElementById("nationality").value;
  const photoFile = document.getElementById("photo").files[0];

  if(!photoFile){ alert("Please upload a profile picture."); return; }

  const reader = new FileReader();
  reader.onload = async function(){
    try{
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const uid = userCredential.user.uid;

      await setDoc(doc(db, "users", uid), {
        firstName,
        lastName,
        fullName: firstName + " " + lastName,
        username,
        email,
        pin,
        accountType,
        gender,
        dob,
        ssn,
        address,
        nationality,
        photo: reader.result,
        balance: 1000,
        accountNumber: "AC" + Math.floor(100000 + Math.random()*900000),
        requests: []
      });

      alert("âœ… Account created successfully! Please login.");
      window.location.href = "login.html";
    } catch(err){
      alert("Error: " + err.message);
    }
  };
  reader.readAsDataURL(photoFile);
});
</script>

</body>
</html>
